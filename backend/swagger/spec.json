{"openapi":"3.0.0","info":{"title":"API","version":"1.0.0"},"paths":{"/users/":{"post":{"summary":"Add a customer","security":[{"bearerAuth":[]}],"tags":["Customer"],"responses":{"200":{"$ref":"#/components/responses/UserAdded"},"400":{"$ref":"#/components/responses/ValidationError"},"500":{"description":"Error Server"}}},"get":{"summary":"An administrator want see the users.","security":[{"bearerAuth":[]}],"tags":["Customer"],"responses":{"200":{"$ref":"#/components/responses/ReadedUser"},"400":{"$ref":"#/components/responses/InvalidRole"},"401":{"$ref":"#/components/responses/UnauthorizedError"},"403":{"$ref":"#/components/responses/mustBeAdmin"},"500":{"description":"Server error"}}}},"/users/me":{"get":{"summary":"The users want see this own account.","security":[{"bearerAuth":[]}],"tags":["Customer"],"responses":{"200":{"description":"User profile returned","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Client"}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"404":{"$ref":"#/components/responses/UserAccount"},"500":{"description":"Server error"}}}},"/users":{"patch":{"summary":"A user wants to update their account, or only an administrator can update a customer account.","security":[{"bearerAuth":[]}],"tags":["Customer"],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/updateSchema"}}}},"responses":{"400":{"$ref":"#/components/responses/ValidationError"},"401":{"$ref":"#/components/responses/UnauthorizedError"},"403":{"$ref":"#/components/responses/AccessDeniedError"},"404":{"$ref":"#/components/responses/UserNotFound"},"500":{"description":"Error server"}}}},"/comments/":{"get":{"summary":"Retrieve a list of comments","parameters":[{"name":"commentDate","in":"query","required":true,"schema":{"type":"string","format":"date"},"description":"Filter comments by date (optional)"},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1},"description":"Page number for pagination"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":10},"description":"Number of comments per page"}],"security":[{"bearerAuth":[]}],"tags":["Comment"],"responses":{"200":{"$ref":"#/components/responses/CommentsReaded"},"401":{"$ref":"#/components/responses/UnauthorizedError"},"500":{"description":"Server error"}}},"post":{"summary":"Add a comment","security":[{"bearerAuth":[]}],"tags":["Comment"],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/createCommentSchema"}}}},"responses":{"200":{"$ref":"#/components/responses/CommentAdded"},"400":{"$ref":"#/components/responses/ValidationError"},"401":{"$ref":"#/components/responses/UnauthorizedError"},"500":{"description":"Server error"}}}},"/comments/{id}":{"patch":{"summary":"An administrator updates a comment","security":[{"bearerAuth":[]}],"tags":["Comment"],"parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/updateCommentSchema"}}}},"responses":{"200":{"$ref":"#/components/responses/CommentUpdated"},"400":{"$ref":"#/components/responses/ValidationError"},"401":{"$ref":"#/components/responses/UnauthorizedError"},"404":{"$ref":"#/components/responses/CommentNotFound"},"500":{"description":"Server error"}}},"delete":{"summary":"An administrator deletes a comment","description":"Delete a specific comment","security":[{"bearerAuth":[]}],"tags":["Comment"],"parameters":[{"name":"id","in":"path","required":true,"description":"ID of the comment to delete","schema":{"type":"integer"}}],"responses":{"204":{"$ref":"#/components/responses/CommentDeleted"},"401":{"$ref":"#/components/responses/UnauthorizedError"},"404":{"$ref":"#/components/responses/CommentNotFound"},"500":{"description":"Server error"}}}},"/login":{"post":{"summary":"Authenticates a customer","tags":["Niveau principal"],"security":[{"bearerAuth":[]}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/loginSchema"}}}},"responses":{"200":{"$ref":"#/components/responses/ConnectionSuccess"},"400":{"$ref":"#/components/responses/ValidationError"},"401":{"$ref":"#/components/responses/InvalidInput"},"500":{"description":"Error server"}}}},"/loginWithGoogle":{"post":{"summary":"Authenticates a customer with Google","tags":["Niveau principal"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/loginSchema"}}}},"responses":{"200":{"$ref":"#/components/responses/ConnectionSuccess"},"401":{"$ref":"#/components/responses/InvalidInput"}}}},"/stats":{"post":{"summary":"Get all application statistics","tags":["Niveau principal"],"responses":{"200":{"$ref":"#/components/responses/AllStatReaded"},"401":{"$ref":"#/components/responses/UnauthorizedError"},"500":{"description":"Error server"}}}},"/getAllCities":{"get":{"summary":"Get the complete list of cities","tags":["Niveau principal"],"responses":{"200":{"$ref":"#/components/responses/ReadAllCities"},"401":{"$ref":"#/components/responses/UnauthorizedError"},"500":{"description":"Error server"}}}}},"components":{"schemas":{"Address":{"type":"object","properties":{"id":{"type":"integer"},"city":{"type":"string"},"postalCode":{"type":"string"}}},"Client":{"type":"object","properties":{"id":{"type":"integer"},"username":{"type":"string"},"street":{"type":"string"},"streetNumber":{"type":"integer"},"photo":{"type":"string"},"email":{"type":"string"},"password":{"type":"string"}}},"Comment":{"type":"object","properties":{"id":{"type":"integer"},"content":{"type":"string"},"date":{"type":"string","format":"date"},"id_post":{"type":"integer"},"id_costumer":{"type":"integer"}}},"DashboardStats":{"type":"object","properties":{"totalAnnonces":{"type":"integer","description":"Total number of posts"},"totalReservation":{"type":"integer","description":"Total number of reservations"},"totalRetraits":{"type":"integer","description":"Total number of withdrawals"},"utilisateursActifs":{"type":"integer","description":"Total number of active users"}}},"Post":{"type":"object","description":"Represents a blog post or article","properties":{"id":{"type":"integer","description":"Unique identifier for the post","example":1},"postDate":{"type":"string","format":"date","description":"Date when the post was created","example":"2023-10-15"},"description":{"type":"string","description":"Detailed content of the post","example":"This is a detailed description of the post..."},"title":{"type":"string","description":"Title of the post","example":"My First Post"},"numberOfPlaces":{"type":"integer","description":"Number of available places (if applicable)","example":10},"postStatus":{"type":"string","description":"Current status of the post","enum":["draft","published","archived"],"example":"published"},"photo":{"type":"string","description":"URL or path to the post's photo","example":"/images/post1.jpg"},"street":{"type":"string","description":"Street name for location-based posts","example":"Main Street"},"streetNumber":{"type":"string","description":"Street number (string to handle cases like \"123A\")","example":"123"},"addressId":{"type":"integer","description":"Reference to the address","example":5},"clientId":{"type":"integer","description":"Reference to the client/author","example":7}}},"Category":{"type":"object","properties":{"idCategory":{"type":"integer"},"nameCategory":{"type":"string"}}},"updateSchema":{"type":"object","properties":{"username":{"type":"string"},"street":{"type":"string"},"streetNumber":{"type":"integer"},"photo":{"type":"string"},"password":{"type":"string"},"isAdmin":{"type":"boolean"}}},"loginSchema":{"type":"object","properties":{"email":{"type":"string"},"password":{"type":"string"}},"required":["email","password"]},"createCommentSchema":{"type":"object","properties":{"content":{"type":"string"},"idPost":{"type":"integer"},"idCustomer":{"type":"integer"}},"required":["content","idPost","idCustomer"]},"updateCommentSchema":{"type":"object","properties":{"content":{"type":"string"}}}},"responses":{"ReadAllCities":{"description":"All cities read from the external API","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Address"}}}}},"UserAdded":{"description":"The user has been added to the database","content":{"application/json":{"schema":{"type":"object","properties":{"token":{"type":"string"}}}}}},"UpdatedUser":{"description":"The user updated in the database","content":{"text/plain":{"schema":{"type":"string"}}}},"InvalidOldPassword":{"description":"Incorrect old password","content":{"text/plain":{"schema":{"type":"string"}}}},"UserNotFound":{"description":"User not found","content":{"text/plain":{"schema":{"type":"string"}}}},"DeletedUser":{"description":"The user is deleted from the database","content":{"text/plain":{"schema":{"type":"string"}}}},"UserAccount":{"description":"The user want see his account","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Client"}}}},"ReadedUser":{"description":"The user wants to read the existing users","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Client"}}}},"InvalidRole":{"description":"The role is invalid","content":{"text/plain":{"schema":{"type":"string"}}}},"CommentAdded":{"description":"The Comment added at the database","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"integer"}}}}}},"CommentUpdated":{"description":"The Comment updated in the database","content":{"text/plain":{"schema":{"type":"string"}}}},"CommentNotFound":{"description":"Comment not found","content":{"application/json":{"schema":{"type":"string"}}}},"CommentDeleted":{"description":"The comment has been deleted from the database","content":{"text/plain":{"schema":{"type":"string"}}}},"CommentsReaded":{"description":"All the comments that correspond to the given date","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Comment"}}}}},"AllStatReaded":{"description":"All stats are obtained","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DashboardStats"}}}},"ConnectionSuccess":{"description":"the token is returned","content":{"application/json":{"schema":{"type":"object","properties":{"token":{"type":"string"}}}}}},"InvalidInput":{"description":"User/password incorrect","content":{"text/plain":{"schema":{"type":"string"}}}},"PostReaded":{"description":"The searched post has been found and read","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Post"}}}},"PostNotFound":{"description":"The searched post does not exist","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Post not found"},"code":{"type":"string","example":"POST_NOT_FOUND"}}}}}},"AllPostsReaded":{"description":"All posts have been successfully retrieved.","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Post"}}}}},"PostCreated":{"description":"Thanks to the transaction, the user was identified and linked to the post, and a row was created in the PostCategory table.","content":{"text/plain":{"schema":{"type":"string"}}}},"UnauthorizedToAccess":{"description":"User is not authorized to access this resource because this is neither a user nor an administrator","content":{"text/plain":{"schema":{"type":"string"}}}},"PostUpdated":{"description":"The requested post has been updated.","content":{"text/plain":{"schema":{"type":"string"}}}},"PostDeleted":{"description":"The requested post has been deleted.","content":{"text/plain":{"schema":{"type":"string"}}}},"AllPostByCategory":{"description":"Requested posts from a certain category are returned.","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Post"}}}}},"CategoryReaded":{"description":"Category successfully retrieved","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Category"}}}},"CategoryProductCreated":{"description":"The requested category of product has been created successfully.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Category"}}}},"ExistingType":{"description":"The requested category already exists (duplicates are not allowed).","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Conflict"},"message":{"type":"string","example":"Category already exists"},"code":{"type":"string","example":"DUPLICATE_CATEGORY"}}}}}},"TypeProductUpdated":{"description":"The requested type of product is successfully updated","content":{"text/plain":{"schema":{"type":"string","example":"Type product updated successfully"}}}},"TypeProductNotFound":{"description":"The requested type of product was not found","content":{"text/plain":{"schema":{"type":"string","example":"Type product not found"}}}},"TypeProductDeleted":{"description":"The requested type of product is deleted.","content":{"text/plain":{"schema":{"type":"string"}}}},"UnauthorizedError":{"description":"Access token is missing or invalid","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Unauthorized"},"message":{"type":"string","example":"JWT is missing or invalid"}}}}}},"mustBeAdmin":{"description":"User verification requires administrator privileges","content":{"text/plain":{"schema":{"type":"string","example":"Admin privileges required"}}}},"AccessDeniedError":{"description":"Not the same user or not an admin","content":{"text/plain":{"schema":{"type":"string","example":"Access denied"}}}},"ValidationError":{"description":"the error(s) described","content":{"text/plain":{"schema":{"type":"string"}}}}},"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}}},"tags":[]}