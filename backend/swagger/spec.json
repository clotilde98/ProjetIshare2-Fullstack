{
  "openapi": "3.0.0",
  "info": {
    "title": "API",
    "version": "1.0.0"
  },
  "components": {
    "responses": {
      "ObjectNotFound": {
        "description": "Not found",
        "content": {
          "text/plain": {
            "schema": {
              "type": "string"
            }
          }
        }
      },
      "ObjectCompetingEdition": {
        "description": "Already exists",
        "content": {
          "text/plain": {
            "schema": {
              "type": "string"
            }
          }
        }
      },
      "AccessDeniedError": {
        "description": "Admin privilege required",
        "content": {
          "text/plain": {
            "schema": {
              "type": "string"
            }
          }
        }
      },
      "ReadAllCities": {
        "description": "All cities read from the external API",
        "content": {
          "application/json": {
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/components/schemas/Address"
              }
            }
          }
        }
      },
      "UserAdded": {
        "description": "The user has been added to the database",
        "content": {
          "application/json": {
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/Client"
                },
                {
                  "type": "object",
                  "properties": {
                    "token": {
                      "type": "string"
                    }
                  }
                }
              ]
            }
          }
        }
      },
      "UserAccount": {
        "description": "The user want see his account",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Client"
            }
          }
        }
      },
      "ReadAllUsers": {
        "description": "The admin read all users",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "username": {
                  "type": "string"
                },
                "email": {
                  "type": "string"
                },
                "registration_date": {
                  "type": "string",
                  "format": "date"
                },
                "address_id": {
                  "type": "integer"
                },
                "is_admin": {
                  "type": "boolean"
                },
                "city": {
                  "type": "string"
                },
                "postal_code": {
                  "type": "string"
                },
                "street": {
                  "type": "string"
                },
                "street_number": {
                  "type": "integer"
                }
              }
            }
          }
        }
      },
      "InvalidRole": {
        "description": "role must be 'admin' or 'user'",
        "content": {
          "text/plain": {
            "schema": {
              "type": "string"
            }
          }
        }
      },
      "CommentAdded": {
        "description": "The Comment added at the database",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Comment"
            }
          }
        }
      },
      "CommentUpdated": {
        "description": "The Comment updated in the database",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Comment"
            }
          }
        }
      },
      "CommentsRead": {
        "description": "All the comments that correspond to the given date",
        "content": {
          "application/json": {
            "schema": {
              "type": "array",
              "items": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/Comment"
                  },
                  {
                    "type": "object",
                    "properties": {
                      "post_title": {
                        "type": "string"
                      },
                      "username": {
                        "type": "string"
                      }
                    }
                  }
                ]
              }
            }
          }
        }
      },
      "AllStatReaded": {
        "description": "All stats are obtained",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/DashboardStats"
            }
          }
        }
      },
      "ConnectionSuccess": {
        "description": "the token is returned",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "token": {
                  "type": "string"
                }
              }
            }
          }
        }
      },
      "InvalidInput": {
        "description": "User/password incorrect",
        "content": {
          "text/plain": {
            "schema": {
              "type": "string"
            }
          }
        }
      },
      "PostResponse": {
        "description": "The searched post has been found and read",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Post"
            }
          }
        }
      },
      "AllPostsRead": {
        "description": "All posts have been successfully retrieved.",
        "content": {
          "application/json": {
            "schema": {
              "type": "array",
              "items": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/Post"
                  },
                  {
                    "type": "object",
                    "properties": {
                      "places_restantes": {
                        "type": "integer"
                      },
                      "username": {
                        "type": "integer"
                      },
                      "categories": {
                        "type": "string"
                      },
                      "postal_code": {
                        "type": "string"
                      },
                      "city": {
                        "type": "string"
                      }
                    }
                  }
                ]
              }
            }
          }
        }
      },
      "AllPostByCategory": {
        "description": "Requested posts from a certain category are returned.",
        "content": {
          "application/json": {
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/components/schemas/Post"
              }
            }
          }
        }
      },
      "CategoriesRead": {
        "description": "Category successfully retrieved",
        "content": {
          "application/json": {
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/components/schemas/Category"
              }
            }
          }
        }
      },
      "CategoryProductCreated": {
        "description": "The requested category of product has been created successfully.",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Category"
            }
          }
        }
      },
      "TypeProductUpdated": {
        "description": "The requested type of product is successfully updated",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Category"
            }
          }
        }
      },
      "ReservationsList": {
        "description": "List of reservations depending on the function used",
        "content": {
          "application/json": {
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/components/schemas/Reservation"
              }
            }
          }
        }
      },
      "ReservationResponse": {
        "description": "The reservation object is returned",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Reservation"
            }
          }
        }
      },
      "UnauthorizedError": {
        "description": "Access token is missing or is invalid",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "error": {
                  "type": "string",
                  "example": "Unauthorized"
                },
                "message": {
                  "type": "string",
                  "example": "JWT is missing or is invalid"
                }
              }
            }
          }
        }
      },
      "ValidationError": {
        "description": "the error(s) described",
        "content": {
          "text/plain": {
            "schema": {
              "type": "string"
            }
          }
        }
      }
    },
    "schemas": {
      "Address": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "city": {
            "type": "string"
          },
          "postalCode": {
            "type": "string"
          }
        }
      },
      "Client": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "username": {
            "type": "string"
          },
          "email": {
            "type": "string"
          },
          "photo": {
            "type": "string",
            "nullable": true
          },
          "googleid": {
            "type": "string",
            "nullable": true
          },
          "street": {
            "type": "string"
          },
          "street_number": {
            "type": "integer"
          },
          "registration_date": {
            "type": "string",
            "format": "date"
          },
          "isadmin": {
            "type": "boolean"
          },
          "address_id": {
            "type": "integer"
          }
        }
      },
      "Comment": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "content": {
            "type": "string"
          },
          "date": {
            "type": "string",
            "format": "date"
          },
          "id_post": {
            "type": "integer"
          },
          "id_costumer": {
            "type": "integer"
          }
        }
      },
      "DashboardStats": {
        "type": "object",
        "properties": {
          "totalAnnonces": {
            "type": "integer",
            "description": "Total number of posts"
          },
          "totalReservation": {
            "type": "integer",
            "description": "Total number of reservations"
          },
          "totalRetraits": {
            "type": "integer",
            "description": "Total number of withdrawals"
          },
          "utilisateursActifs": {
            "type": "integer",
            "description": "Total number of active users"
          }
        }
      },
      "Post": {
        "type": "object",
        "description": "Represents a blog post or article",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Unique identifier for the post"
          },
          "post_date": {
            "type": "string",
            "format": "date",
            "description": "Date when the post was created"
          },
          "description": {
            "type": "string",
            "description": "Detailed content of the post"
          },
          "title": {
            "type": "string",
            "description": "Title of the post"
          },
          "number_of_places": {
            "type": "integer"
          },
          "post_status": {
            "type": "string",
            "description": "Current status of the post",
            "enum": [
              "available",
              "unavailable"
            ]
          },
          "photo": {
            "type": "string",
            "description": "A local URL pointing to an image on the development server"
          },
          "street": {
            "type": "string",
            "description": "Street name for location-based posts"
          },
          "street_number": {
            "type": "string"
          },
          "address_id": {
            "type": "integer",
            "description": "Reference to the address"
          },
          "client_id": {
            "type": "integer",
            "description": "Reference to the client"
          }
        }
      },
      "Category": {
        "type": "object",
        "properties": {
          "idCategory": {
            "type": "integer"
          },
          "nameCategory": {
            "type": "string"
          }
        }
      },
      "Reservation": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "reservation_date": {
            "type": "string",
            "format": "date"
          },
          "reservation_status": {
            "type": "string"
          },
          "post_id": {
            "type": "integer"
          },
          "client_id": {
            "type": "integer"
          },
          "title": {
            "type": "string"
          },
          "username": {
            "type": "string"
          }
        }
      },
      "CreateCategoryProductSchema": {
        "type": "object",
        "properties": {
          "nameCategory": {
            "type": "string"
          }
        }
      },
      "UpdateCategoryProductSchema": {
        "type": "object",
        "properties": {
          "nameCategory": {
            "type": "string"
          }
        }
      },
      "AddClientSchema": {
        "type": "object",
        "properties": {
          "username": {
            "type": "string"
          },
          "street": {
            "type": "string"
          },
          "streetNumber": {
            "type": "integer"
          },
          "email": {
            "type": "string"
          },
          "password": {
            "type": "string"
          }
        },
        "required": [
          "username",
          "street",
          "streetNumber",
          "email",
          "password"
        ]
      },
      "UpdateSchema": {
        "type": "object",
        "properties": {
          "username": {
            "type": "string"
          },
          "street": {
            "type": "string"
          },
          "streetNumber": {
            "type": "integer"
          },
          "oldPpassword": {
            "type": "string"
          },
          "password": {
            "type": "string"
          },
          "isAdmin": {
            "type": "boolean"
          }
        }
      },
      "loginSchema": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string"
          },
          "password": {
            "type": "string"
          },
          "idToken": {
            "type": "string"
          }
        },
        "required": [
          "email"
        ]
      },
      "CreateCommentSchema": {
        "type": "object",
        "properties": {
          "content": {
            "type": "string"
          },
          "idPost": {
            "type": "integer"
          },
          "idCustomer": {
            "type": "integer"
          }
        },
        "required": [
          "content",
          "idPost",
          "idCustomer"
        ]
      },
      "UpdateCommentSchema": {
        "type": "object",
        "properties": {
          "content": {
            "type": "string"
          }
        }
      },
      "CreatePostSchema": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "street": {
            "type": "string"
          },
          "streetNumber": {
            "type": "integer"
          },
          "numberOfPlaces": {
            "type": "integer"
          },
          "addressID": {
            "type": "integer"
          },
          "categoriesProduct": {
            "type": "string"
          }
        },
        "required": [
          "title",
          "description",
          "street",
          "streetNumber",
          "numberOfPlaces",
          "addressID",
          "categoriesProduct"
        ]
      },
      "UpdatePostSchema": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "street": {
            "type": "string"
          },
          "streetNumber": {
            "type": "integer"
          },
          "numberOfPlaces": {
            "type": "integer"
          },
          "postStatus": {
            "type": "string",
            "enum": [
              "available",
              "unavailable"
            ]
          },
          "categoriesProduct": {
            "type": "string"
          }
        }
      },
      "CreateReservationSchema": {
        "type": "object",
        "properties": {
          "postID": {
            "type": "integer"
          }
        },
        "required": [
          "postID"
        ]
      },
      "UpdateReservationSchema": {
        "type": "object",
        "properties": {
          "reservationStatus": {
            "type": "string",
            "enum": [
              "confirmed",
              "cancelled",
              "withdrawal"
            ]
          }
        }
      }
    },
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  },
  "paths": {
    "/users/": {
      "post": {
        "summary": "Add a customer",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Customer"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/AddClientSchema"
                  },
                  {
                    "type": "object",
                    "properties": {
                      "photo": {
                        "type": "string",
                        "format": "binary"
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/UserAdded"
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "409": {
            "$ref": "#/components/responses/ObjectCompetingEdition"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "get": {
        "summary": "An administrator want see the users.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Customer"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/ReadAllUsers"
          },
          "400": {
            "$ref": "#/components/responses/InvalidRole"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "patch": {
        "summary": "A user or an administrator wants to update his account",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Customer"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/UpdateSchema"
                  },
                  {
                    "type": "object",
                    "properties": {
                      "photo": {
                        "type": "string",
                        "format": "binary"
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/UserAccount"
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "401": {
            "description": "Invalid or expired JWT OR current password incorrect",
            "content": {
              "text/Plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/users/admin": {
      "post": {
        "summary": "Add a new customer (admin only)",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Customer"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/AddClientSchema"
                  },
                  {
                    "type": "object",
                    "properties": {
                      "photo": {
                        "type": "string",
                        "format": "binary"
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/UserAdded"
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "409": {
            "$ref": "#/components/responses/ObjectCompetingEdition"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/users/me": {
      "get": {
        "summary": "The users want see this own account.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Customer"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/UserAccount"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "$ref": "#/components/responses/UserAccount"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/users": {
      "delete": {
        "summary": "User deletes their own account",
        "tags": [
          "Customer"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "The user is deleted from the database",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/users/{id}": {
      "delete": {
        "summary": "A user wants to delete their account, or only an administrator can delete an account.",
        "tags": [
          "Customer"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "The user is deleted from the database",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "patch": {
        "summary": "A user or an administrator wants to update his account",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Customer"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/UpdateSchema"
                  },
                  {
                    "type": "object",
                    "properties": {
                      "photo": {
                        "type": "string",
                        "format": "binary"
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/UserAccount"
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "401": {
            "description": "Invalid or expired JWT OR current password incorrect",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/comments/": {
      "get": {
        "summary": "Retrieve a list of comments",
        "parameters": [
          {
            "name": "commentDate",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "format": "date"
            },
            "description": "Filter comments by date (optional)"
          },
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 1
            },
            "description": "Page number for pagination"
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 10
            },
            "description": "Number of comments per page"
          }
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Comment"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/CommentsRead"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/comments": {
      "post": {
        "summary": "Add a comment",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Comment"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateCommentSchema"
              }
            }
          }
        },
        "responses": {
          "201": {
            "$ref": "#/components/responses/CommentAdded"
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/comments/{id}": {
      "patch": {
        "summary": "An administrator updates a comment",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Comment"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateCommentSchema"
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/CommentUpdated"
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "delete": {
        "summary": "An administrator deletes a comment",
        "description": "Delete a specific comment",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Comment"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "ID of the comment to delete",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "The comment has been deleted from the database",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/login": {
      "post": {
        "summary": "Authenticates a customer",
        "tags": [
          "Niveau principal"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/loginSchema"
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/ConnectionSuccess"
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "401": {
            "$ref": "#/components/responses/InvalidInput"
          },
          "500": {
            "description": "Error server"
          }
        }
      }
    },
    "/loginWithGoogle": {
      "post": {
        "summary": "Authenticates a customer with Google",
        "tags": [
          "Niveau principal"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/loginSchema"
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/ConnectionSuccess"
          },
          "401": {
            "$ref": "#/components/responses/InvalidInput"
          }
        }
      }
    },
    "/stats": {
      "post": {
        "summary": "Get all application statistics",
        "tags": [
          "Niveau principal"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/AllStatReaded"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "500": {
            "description": "Error server"
          }
        }
      }
    },
    "/getAllCities": {
      "get": {
        "summary": "Get the complete list of cities",
        "tags": [
          "Niveau principal"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/ReadAllCities"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "500": {
            "description": "Error server"
          }
        }
      }
    },
    "/posts/": {
      "post": {
        "summary": "Whether they are an administrator or a user, they can create a post and send confirmation of its creation.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Post"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/CreatePostSchema"
                  },
                  {
                    "type": "object",
                    "properties": {
                      "photo": {
                        "type": "string",
                        "format": "binary"
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "$ref": "#/components/responses/PostResponse"
          },
          "400": {
            "description": "Validation error OR Post category missing",
            "content": {
              "text/Plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "get": {
        "summary": "Get posts with filters",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Post"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "city",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "postStatus",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "page",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/AllPostsRead"
          },
          "400": {
            "description": "The requested page and its limit must both be a number.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "500": {
            "description": "Server Error"
          }
        }
      }
    },
    "/byCategory": {
      "get": {
        "summary": "Retrieve posts by category",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Post"
        ],
        "parameters": [
          {
            "name": "nameCategory",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/AllPostByCategory"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/posts/{id}": {
      "get": {
        "summary": "Return an existing post using the received ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "tags": [
          "Post"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/PostResponse"
          },
          "400": {
            "description": "Invalid post ID",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "patch": {
        "summary": "Updates an existing post with the option to upload a file.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/UpdatePostSchema"
                  },
                  {
                    "type": "object",
                    "properties": {
                      "photo": {
                        "type": "string",
                        "format": "binary"
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "tags": [
          "Post"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/PostResponse"
          },
          "400": {
            "description": "Validation error OR Post category missing",
            "content": {
              "text/Plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "delete": {
        "summary": "Delete a post using the ID",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Post"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "The requested post has been deleted.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/productType": {
      "post": {
        "summary": "An administrator can create a category type",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "ProductType"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateCategoryProductSchema"
              }
            }
          }
        },
        "responses": {
          "201": {
            "$ref": "#/components/responses/CategoryProductCreated"
          },
          "400": {
            "description": "ValidationError or Category name required",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "409": {
            "$ref": "#/components/responses/ObjectCompetingEdition"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/productType/": {
      "get": {
        "summary": "Get categories filtered by name",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "ProductType"
        ],
        "parameters": [
          {
            "name": "nameCategory",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "required": true
          },
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 1
            },
            "required": false
          },
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 10
            },
            "required": false
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/CategoriesRead"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/productType/{id}": {
      "patch": {
        "summary": "Only an administrator can modify a product category",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "ProductType"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateCategoryProductSchema"
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/TypeProductUpdated"
          },
          "400": {
            "description": "Validation error or category id invalid",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "delete": {
        "summary": "Delete a category product by ID",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "ProductType"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "The requested type of product was deleted.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "400": {
            "description": "Missing product category ID",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/reservations": {
      "post": {
        "summary": "Create a reservation for a specific post for a user or create it yourself",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Reservation"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateReservationSchema"
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/ReservationResponse"
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "description": "Must be admin or reservation owner or must not be post owner",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "409": {
            "description": "Impossible to create a reservation for a post with a status unavailable or capacity reached or reservation already exists",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "get": {
        "summary": "The administrator wants to see the reservations made in the database.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Reservation"
        ],
        "parameters": [
          {
            "name": "username",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 1
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 10
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/ReservationsList"
          },
          "400": {
            "description": "Bad status, non-existent status in the choices",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/reservations/me": {
      "get": {
        "summary": "The user wants to see their reservations",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Reservation"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/ReservationsList"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/reservations/client/{id}": {
      "get": {
        "summary": "Only an administrator can see all the reservations a customer has made",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Reservation"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/ReservationsList"
          },
          "400": {
            "description": "Invalid client ID",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server Error"
          }
        }
      }
    },
    "/reservations/post/{id}": {
      "get": {
        "summary": "As an administrator, you can see the reservations for a specific post",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Reservation"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/ReservationsList"
          },
          "400": {
            "description": "Invalid post ID",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/reservations/{id}": {
      "get": {
        "summary": "The administrator can view a reservation, the user only their own reservation",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Reservation"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/ReservationResponse"
          },
          "400": {
            "description": "Invalid reservation ID",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server Error"
          }
        }
      },
      "patch": {
        "summary": "Update a reservation",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Reservation"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateReservationSchema"
              }
            }
          }
        },
        "responses": {
          "200": {
            "$ref": "#/components/responses/ReservationResponse"
          },
          "400": {
            "description": "Validation error or reservation status can only be confirmed, cancelled or withdrawal"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "description": "Must be admin or reservation owner or must not be post owner",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "delete": {
        "summary": "Delete a reservation by ID",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Reservation"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "Reservation ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Reservation deleted successfully",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "400": {
            "description": "Invalid reservation ID",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/AccessDeniedError"
          },
          "404": {
            "$ref": "#/components/responses/ObjectNotFound"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    }
  },
  "tags": []
}